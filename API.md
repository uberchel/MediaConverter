# üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

MediaConverter ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –ø—É–±–ª–∏—á–Ω—ã–π API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—á–µ—Ä–µ–¥—å—é –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤–∏–¥–µ–æ –∏ –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤.

- **`MediaConverter`** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π
- **`convert`** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏

## üì¶ –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å

### `MediaConverter`

#### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
```typescript
constructor(options: MediaConverterOptions)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `options.dir` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ñ–∞–π–ª–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, './uploads')
- `options.eventURL?` ‚Äî URL –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü—Ä–∏–º–µ—Ä:**
```typescript
import MediaConverter from "./index.js";

const conv = new MediaConverter({
    dir: "./uploads",
    eventURL: "http://localhost/api/"
});
```

#### –ú–µ—Ç–æ–¥: `convert`

```typescript
convert(options: ConversionTask): void
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `options.inputFile` ‚Äî –∏–º—è –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `options.format` ‚Äî —Ü–µ–ª–µ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'mp4', 'webm', 'mp3', ...)
- `options.size?` ‚Äî —Ä–∞–∑–º–µ—Ä –≤–∏–¥–µ–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, '1920x1080')
- `options.aspect?` ‚Äî —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, '16:9')
- `options.quality?` ‚Äî —É—Ä–æ–≤–µ–Ω—å –∫–∞—á–µ—Å—Ç–≤–∞ ('low' | 'medium' | 'high' | 'ultra')
- `options.videoCodec?` ‚Äî –≤–∏–¥–µ–æ –∫–æ–¥–µ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'libx264')
- `options.audioCodec?` ‚Äî –∞—É–¥–∏–æ –∫–æ–¥–µ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'aac')
- `options.videoBitrate?` ‚Äî –≤–∏–¥–µ–æ –±–∏—Ç—Ä–µ–π—Ç (kbps)
- `options.audioBitrate?` ‚Äî –∞—É–¥–∏–æ –±–∏—Ç—Ä–µ–π—Ç (kbps)

**–ü—Ä–∏–º–µ—Ä:**
```typescript
conv.convert({
    format: "mp4",
    inputFile: "video.mp4",
    quality: "high",
    size: "1920x1080"
});
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞—á–µ—Å—Ç–≤–∞—Ö –∏ —Ñ–æ—Ä–º–∞—Ç–∞—Ö

```typescript
conv.converter.getQualityLevels(); // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö –∫–∞—á–µ—Å—Ç–≤–∞
conv.converter.getAvailableFormats(); // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
```

## üéØ –£—Ä–æ–≤–Ω–∏ –∫–∞—á–µ—Å—Ç–≤–∞

| –£—Ä–æ–≤–µ–Ω—å | –û–ø–∏—Å–∞–Ω–∏–µ | –í–∏–¥–µ–æ –±–∏—Ç—Ä–µ–π—Ç | –ê—É–¥–∏–æ –±–∏—Ç—Ä–µ–π—Ç | CRF | –ü—Ä–µ—Å–µ—Ç |
|---------|----------|---------------|---------------|-----|--------|
| `low` | –ë—ã—Å—Ç—Ä–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ | √ó0.5 | √ó0.5 | 28 | fast |
| `medium` | –ë–∞–ª–∞–Ω—Å –∫–∞—á–µ—Å—Ç–≤–∞/—Ä–∞–∑–º–µ—Ä–∞ | √ó1.0 | √ó1.0 | 23 | medium |
| `high` | –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ | √ó1.5 | √ó1.2 | 18 | slow |
| `ultra` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ | √ó2.0 | √ó1.5 | 15 | veryslow |

**–ü—Ä–∏–º–µ—Ä:**
```typescript
conv.convert({
    format: "mp4",
    inputFile: "video.mp4",
    quality: "low"
});
```

## üìπ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

| –§–æ—Ä–º–∞—Ç | –í–∏–¥–µ–æ –∫–æ–¥–µ–∫ | –ê—É–¥–∏–æ –∫–æ–¥–µ–∫ | –ë–∞–∑–æ–≤—ã–π –≤–∏–¥–µ–æ –±–∏—Ç—Ä–µ–π—Ç | –ë–∞–∑–æ–≤—ã–π –∞—É–¥–∏–æ –±–∏—Ç—Ä–µ–π—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-------------|-------------|----------------------|----------------------|----------|
| `mp4` | libx264 | aac | 1200 kbps | 320 kbps | –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç |
| `mkv` | libx264 | aac | 1500 kbps | 320 kbps | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –¥–æ—Ä–æ–∂–∫–∞–º–∏ |
| `webm` | libvpx-vp9 | libopus | 1000 kbps | 128 kbps | –í–µ–±-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π |
| `avi` | libx264 | libmp3lame | 1200 kbps | 320 kbps | –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç |
| `mov` | libx264 | aac | 1200 kbps | 320 kbps | Apple —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π |
| `flv` | libx264 | aac | 800 kbps | 256 kbps | Flash Video |
| `wmv` | wmv2 | wmav2 | 800 kbps | 256 kbps | Windows Media |
| `m4v` | libx264 | aac | 1200 kbps | 320 kbps | iTunes —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π |
| `mp3` | copy | libmp3lame | - | 320 kbps | –ü–æ–ø—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏–æ —Ñ–æ—Ä–º–∞—Ç |
| `wav` | copy | pcm_s16le | - | 1411 kbps | –ê—É–¥–∏–æ –±–µ–∑ –ø–æ—Ç–µ—Ä—å |
| `aac` | copy | aac | - | 256 kbps | –í—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—É–¥–∏–æ |
| `ogg` | copy | libvorbis | - | 192 kbps | –û—Ç–∫—Ä—ã—Ç—ã–π –∞—É–¥–∏–æ —Ñ–æ—Ä–º–∞—Ç |
| `flac` | copy | flac | - | 0 (–±–µ–∑ –ø–æ—Ç–µ—Ä—å) | –ê—É–¥–∏–æ –±–µ–∑ –ø–æ—Ç–µ—Ä—å |
| `wma` | copy | wmav2 | - | 256 kbps | Windows Media Audio |
| `m4a` | copy | aac | - | 256 kbps | iTunes —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –∞—É–¥–∏–æ |

## üîß –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```typescript
// –ö–∞—Å—Ç–æ–º–Ω—ã–µ –±–∏—Ç—Ä–µ–π—Ç—ã (–∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ)
conv.convert({
    format: "mp4",
    inputFile: "video.mp4",
    videoBitrate: 2048,
    audioBitrate: 320
});

// –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–æ–¥–µ–∫–∏
conv.convert({
    format: "mp4",
    inputFile: "video.mp4",
    videoCodec: "libx265",
    audioCodec: "aac"
});

// –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω
conv.convert({
    format: "mp4",
    inputFile: "video.mp4",
    size: "1280x720",
    aspect: "16:9"
});
```

## üìä –°–æ–±—ã—Ç–∏—è

–°–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω eventURL. –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π: queue, start, progress, complete, error.

## üìù –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```typescript
import MediaConverter from "./index.js";

const conv = new MediaConverter({
    dir: "./uploads",
    eventURL: "http://localhost/api/"
});

conv.convert({
    format: "mp4",
    inputFile: "video.mp4",
    quality: "high"
});
``` 